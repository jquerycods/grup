SpilGames({name:"wdg_popup_register_feedback",waiton:"spilgames.loaded"},"SWPUtils SWP SWPEvent JSLib DOMSelect PopupRegisterFeedback PopupRegisterFeedbackHelper Portal".split(" "),function(f,b,g,k,c,d,m,q){function h(a){k("api.user.get",function(b){a(b)})}b.init("popup_register_feedback");var l=b.getProperty("show_popup_contents"),e=function(){var a=!1;return function(){a||(m.init(".wdg_popup_register_feedback"),d.init({container:".wdg_popup_register_feedback",elements:{closeButton:"popup-register-feedback-close"}}),
a=!0)}}();b.System.init(function(a){var k,n,c,g=a.body&&a.body.type,f=a.body&&a.body.username;switch(a.name){case "popup.register.feedback":var r=function(){e();n={username:f||""};c="";h(function(a){if(!a.error&&a.userInfo){n.username=a.userInfo.name||n.username;c=a.userInfo.avatarUrl;a=a.userInfo.guid;q.get("siteid");var e=document.getElementById("wdg_popup_register_feedback_version"),f=document.getElementById("wdg_prf_campaignid"),l=document.getElementById("wdg_prf_productid"),h=document.getElementById("wdg_prf_conversiontype");
if(null!==e&&"object"==typeof e&&""!=f.value&&""!=l.value&&""!=h.value){var p=document.createElement("IFRAME");p.setAttribute("src","/wdg/popup_register_feedback-"+e.value+"/tt/conversion.html?campaignID="+f.value+"&productID="+l.value+"&conversionType="+h.value+"&GUID="+a+"&transactionID="+a);p.style.width="1px";p.style.height="1px";document.body.appendChild(p)}}k=m.whichPopupToShow(g,c);d.open(k,n);b.System.emit("popup.header.open")})};l?!0===l&&r():(l="loading",b.Widget.refresh({show_popup_contents:!0},
{callback:function(){setTimeout(function(){l=!0;r()},0)}}))}});g.listen("popup.registration.feedback.closed",function(){b.System.emit("registration.finished");b.System.emit("popup.header.close")})});SpilGames("spilgames.import",{name:"PopupRegisterFeedbackHelper",deps:["DOMSelect"],module:function(f){function b(){var b=!1,c=f.get(g);c&&(b="true"===c.getAttribute("data-on-social-game-page"));return b}var g;return{init:function(b){g=b},whichPopupToShow:function(k,c){var d;switch(k){case "link":b()?d="link-social":(d=(c||"").split("/").pop(),d="dummy_small.png"!==d&&"dummy_small.gif"!==d?"link-regular":"link-regular-without-avatar");break;default:case "register":d=b()?"registration-social":"registration-regular"}return d}}}});SpilGames("spilgames.import",{name:"PopupRegisterFeedback",deps:["SWPEvent","SWPUtils","Utils","DOMSelect","DOMEvent"],module:function(f,b,g,k,c){var d,m,q=function(e){c.add(d,"click",function(a){b.hasClass(a.target||a.srcElement,e.closeButton)&&h()})},h=function(){f.emit("popup.registration.feedback.closed");b.addClass(m,"hidden")},l=function(){var e=k.getAll(d+" > article");g.each(e,function(a,d,e){b.hasClass(a,"hidden")||b.addClass(a,"hidden")})};return{init:function(b){d=b.container;m=k.get(d);
q(b.elements)},open:function(e,a){if(e){l();var c,f,g,h;if(a){g=k.get(d+" > #"+e);h=g.innerHTML;for(c in a)a.hasOwnProperty(c)&&(f=new RegExp("\\["+c+"\\]","g"),h=h.replace(f,a[c]));g.innerHTML=h}(c=k.get(d+" > #"+e))&&b.removeClass(c,"hidden");b.removeClass(m,"hidden")}},close:h}}});