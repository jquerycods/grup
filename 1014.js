SpilGames("SWP Utils DOMSelect Cache DOMEvent Slider BeLazy Tooltip Cookie Net ThumbnailTracker".split(" "),function(d,f,m,k,C,D,n,E,r,t,F){d.init("recent_played_games");var u=window.document,g=u.getElementById("wdg_recent_played_games"),c=d.getProperty("*"),v=c.global_user_id,w=c.siteid,x=d.get("spilgames.module.spapi.backend"),l="recent.played.games."+c.global_user_id,h=function(a,b){k.getItem("backend"===a?l:"recent.played.games",function(a){b(f.isArray(a)?a:[])})},p=function(a,b){k.setItem({key:"backend"===
a?l:"recent.played.games",value:b.slice(0,c.games_limit_client_storage),expires:15552E3})},H=function(a){k.getItem(l+".synced",function(b){a(f.isBoolean(b)?b:!1)})},q=function(a){k.setItem({key:l+".synced",value:!0===a,expires:2592E3})},I=function(a){var b={url:x+"v1/recently-played/"+w+"/"+v+"/"+a,type:"PUT",dataType:"text",data:"",headers:{"x-auth-token":r.getItem("token")}};y("backend",a,!0);t.send(b,function(a){a.isError&&q(!1)})},J=function(a){var b=[];a.forEach(function(a){b.push({id:a,date:0})});
a={url:x+"v1/recently-played/"+w+"/"+v,type:"POST",dataType:"json",data:JSON.stringify({items:b.slice(0,c.games_limit_authenticated)}),headers:{"x-auth-token":r.getItem("token")}};t.send(a,function(a){a.isError?q(!1):q(!0)})},y=function(a,b,G){a=a||c.storage_endpoint;b=b||c.app_id;"backend"!==a||G?h(a,function(e){var c=e.indexOf(b);-1<c&&e.splice(c,1);e.unshift(b);p(a,e)}):I(b)},L=function(){var a=u.getElementById("authentication-incentive");a&&C.add(a,"click",function(){d.System.emit("popup.register.open")});
"slider"===c.ui_format&&new D({slide:m.get(".slider-slide",g),prev:m.get(".slider-prev",g),next:m.get(".slider-next",g),duration:.4,easing:"ease"});"game_thumb"===c.ui_format&&E.create(".wdg_recent_played_games .recent-game");d.getProperty("no_recent_games")?d.System.emit("recent.played.empty"):(d.System.emit("recent.played.filled"),window.setTimeout(n.trigger,500));n.handleImagesIn(g);F.track(g)},z=function(a,b,c){var e=a[0];e?h(e,function(K){a.shift();b[e]=K;z(a,b,c)}):c(b)},A=function(){if(!0!==
c.track_only){var a=["client"];"backend"===c.storage_endpoint&&(a[1]="backend");z(a,{},function(a){d.Widget.refresh({app_list:JSON.stringify(a),ui_format:c.ui_format,xhr:!0,lazyload_images:c.lazyload_images,lazyload_from_item:c.lazyload_from_item},{callback:L})})}},B=f.once(A);h("client",function(a){var b=a.map(function(a){if(f.isObject(a)&&a.gid)return a.gid}).filter(function(a){return f.isString(a)}),d=a.filter(function(a){return f.isString(a)});a=a.length-b.length-d.length;var e;if(0<b.length||
0<a)e=f.combine(d,b),p("client",e),"backend"===c.storage_endpoint&&h("backend",function(a){0===a.length&&(a=e,p("backend",a))})});(function(a){"backend"===a&&H(function(a){a||h("backend",function(a){a=a.map(function(a){f.isObject(a)&&a.gid&&(a=a.gid);return a}).filter(function(a){return f.isString(a)});0<a.length&&J(a)})})})(c.storage_endpoint);f.isEmpty(c.wait_on_js_event)&&A();n.until("visible",g,function(){d.System.emit("recent.played.visible")});d.System.init(function(a){var b=a&&a.data?a.data:
{};switch(a.name){case "inlinegame.open":case "recent.played.games.update":y(void 0,b.applicationId||void 0,!1);break;case "game.sidepanel.open":"recent_played_games"!==b.item||f.isEmpty(c.wait_on_js_event)||B();break;case c.wait_on_js_event:B()}})});